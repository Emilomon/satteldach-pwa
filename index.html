<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Satteldach – Vollgeschossigkeit</title>
  <meta name="theme-color" content="#0b1020" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <style>
    :root{--bg:#0b1020;--panel:#131a33;--ink:#e8ecff;--muted:#a8b3d9;--roof1:#c74a4a;--roof2:#8e2e2e;--roof-stroke:#5c1f1f;--house:#1b2b57;--house-stroke:#8aa4ff;--accent:#72e6b9;--fillarea:#2ecc71;--window:#cfe7ff;--frame:#8aa4ff;--door:#4b5b86;--handle:#ffd77a;--plan-roof:#8e2e2e;--plan-include:#2ecc71;}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;overflow:hidden}
    body{background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif;display:flex;align-items:center;justify-content:center}
    .card{background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.35);width:min(96vw,1280px);height:100vh;max-height:100vh;padding:18px;display:flex;flex-direction:column;gap:12px;overflow:hidden}
    h1{margin:0;font-size:clamp(18px,2.8vw,26px)}
    p{margin:0;color:var(--muted)}
    .controls{display:flex;flex-direction:column;gap:12px}
    .control-group{display:grid;grid-template-columns:auto 1fr auto;gap:8px 10px;align-items:center}
    input[type=range]{width:100%;height:36px}
    input[type=range]::-webkit-slider-thumb{width:28px;height:28px;border-radius:50%;background:#8aa4ff;border:none;margin-top:-10px}
    input[type=range]::-webkit-slider-runnable-track{height:8px;border-radius:6px;background:#31407a}
    .badge{background:#0f1630;border:1px solid rgba(255,255,255,.08);border-radius:10px;padding:6px 10px;font-variant-numeric:tabular-nums;font-size:16px}
    .views{display:grid;grid-template-columns:1fr 1fr;gap:12px;flex:1 1 auto;min-height:0}
    .view{display:flex;flex-direction:column;gap:8px;min-height:0;position:relative}
    .view-label{position:absolute;top:8px;left:16px;font-size:clamp(14px,2vw,20px);color:var(--ink)}
    .svg-wrap{flex:1 1 auto;min-height:0}
    svg{width:100%;height:100%;background:#0f1630;border-radius:12px;display:block;touch-action:none}
    @media (max-width:900px){.views{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="card">
    <div>
      <div style="height:20px"></div>
      <h1>Satteldach</h1>
      <p>Nutze die Schieberegler um die <strong>Hausbreite</strong> und <strong>Dachneigung</strong> einzustellen.
      <p>Die <strong>Fläche unter dem Dach</strong>, die eine <strong>Höhe</strong> von mehr als <strong>2,30 m</strong> hat wird in <span style="background-color: green;">grün</span> angezeigt. Ab <strong>75%</strong> der darunter liegenden Geschossfläche erscheint <strong>„Vollgeschoss“</strong>.</p>
    </div>
    <div class="controls">
      <div class="control-group">
        <label for="base">Hausbreite (m)</label>
        <input id="base" type="range" min="5" max="20" value="12" step="0.1" />
        <span id="baseOut" class="badge">12.0 m</span>
      </div>
      <div class="control-group">
        <label for="angle">Dachneigung (°)</label>
        <input id="angle" type="range" min="10" max="65" value="30" step="1" />
        <span id="angleOut" class="badge">30°</span>
      </div>
      <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-start">
        <div id="percentInfo" class="badge">0.0% des Dachgeschosses ist höher als 2,30 m (0.00 m von 12.00 m)</div>
      </div>
    </div>
    <div class="views">
      <div class="view">
        <div class="view-label">Ansicht</div>
        <div class="svg-wrap">
          <svg id="svgSide" viewBox="0 0 3000 2000" preserveAspectRatio="xMidYMid meet">
            <defs><linearGradient id="roofGrad" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="var(--roof1)"/><stop offset="100%" stop-color="var(--roof2)"/></linearGradient></defs>
            <rect id="house" fill="var(--house)" stroke="var(--house-stroke)" stroke-width="3"/>
            <rect id="door" fill="var(--door)" stroke="var(--house-stroke)" stroke-width="3"/>
            <circle id="handle" r="10" fill="var(--handle)"/>
            <rect id="winL" fill="var(--window)" stroke="var(--frame)" stroke-width="3"/>
            <line id="winLh" stroke="var(--frame)" stroke-width="2"/>
            <line id="winLv" stroke="var(--frame)" stroke-width="2"/>
            <rect id="winR" fill="var(--window)" stroke="var(--frame)" stroke-width="3"/>
            <line id="winRh" stroke="var(--frame)" stroke-width="2"/>
            <line id="winRv" stroke="var(--frame)" stroke-width="2"/>
            <polygon id="tri" fill="url(#roofGrad)" stroke="var(--roof-stroke)" stroke-width="4"/>
            <line id="lineAB" stroke="#d7e0ff" stroke-width="3"/>
            <line id="lineParallel" stroke="#ffcc70" stroke-dasharray="10 6" stroke-width="3"/>
            <line id="segInside" stroke="var(--accent)" stroke-width="6"/>
            <rect id="fillArea" fill="var(--fillarea)" fill-opacity="0.4"/>
            <text id="fullLabel" fill="#ffffff" font-size="64" text-anchor="middle" dominant-baseline="middle" style="display:none;font-weight:700;">Vollgeschoss</text>
          </svg>
        </div>
      </div>
      <div class="view">
        <div class="view-label">Draufsicht</div>
        <div class="svg-wrap">
          <svg id="svgPlan" viewBox="0 0 3000 2000" preserveAspectRatio="xMidYMid meet">
            <rect id="planEG" fill="var(--house)" stroke="var(--house-stroke)" stroke-width="3"/>
            <rect id="planRoofLeft" fill="var(--plan-roof)" opacity="0.9"/>
            <rect id="planInclude" fill="var(--plan-include)" opacity="0.6"/>
            <rect id="planRoofRight" fill="var(--plan-roof)" opacity="0.9"/>
            <text id="fullLabelPlan" fill="#ffffff" font-size="64" text-anchor="middle" dominant-baseline="middle" style="display:none;font-weight:700;">Vollgeschoss</text>
          </svg>
        </div>
      </div>
    </div>
  </div>
  <script>
    const SCALE=0.01,PARALLEL_M=2.30,WALL_H_M=3.00,PLAN_LEN_M=10.0;const DOOR_W_M=1.00,DOOR_H_M=2.00,WIN_S_M=1.20,WIN_PAD_M=0.50,WIN_Y_OFF_M=0.60;const PARALLEL=PARALLEL_M/SCALE,WALL_H=WALL_H_M/SCALE,PLAN_LEN=PLAN_LEN_M/SCALE;const A0={x:500,y:1400};let A={...A0};let B={x:A.x+(12/SCALE),y:A.y};
const $=(id)=>document.getElementById(id);
const angleInput=$("angle"),baseInput=$("base"),angleOut=$("angleOut"),baseOut=$("baseOut");
// Seitenansicht Elemente
const tri=$("tri"),house=$("house"),fillArea=$("fillArea"),fullLabel=$("fullLabel"),segInside=$("segInside"),lineAB=$("lineAB"),lineParallel=$("lineParallel"),percentInfo=$("percentInfo");
const door=$("door"),handle=$("handle"),winL=$("winL"),winLh=$("winLh"),winLv=$("winLv"),winR=$("winR"),winRh=$("winRh"),winRv=$("winRv");
// Draufsicht Elemente
const fullLabelPlan=$("fullLabelPlan"),planInclude=$("planInclude"),planEG=$("planEG"),planRoofLeft=$("planRoofLeft"),planRoofRight=$("planRoofRight");

const setAttrs=(el,o)=>{for(const k in o)el.setAttribute(k,o[k]);};
const rad=(deg)=>(deg*Math.PI)/180;

function update(){
  const tDeg=+angleInput.value,width_m=+baseInput.value,L=width_m/SCALE;A={...A0};B={x:A.x+L,y:A.y};
  angleOut.textContent=`${tDeg}°`;baseOut.textContent=`${width_m.toFixed(1)} m`;

  const midX=(A.x+B.x)/2;const h=(L/2)*Math.tan(rad(tDeg));const C={x:midX,y:A.y-h};

  // ===== Seitenansicht: Haus, Dach, Punkte, Labels =====
  setAttrs(house,{x:A.x,y:A.y,width:L,height:WALL_H});
  tri.setAttribute('points',`${C.x},${C.y} ${A.x},${A.y} ${B.x},${B.y}`);

 // Tür
  const dW=DOOR_W_M/SCALE,dH=DOOR_H_M/SCALE; const dX=A.x+(L-dW)/2,dY=A.y+WALL_H-dH;
  setAttrs(door,{x:dX,y:dY,width:dW,height:dH}); setAttrs(handle,{cx:dX+dW*0.75,cy:dY+dH/2});

  // Fenster links & rechts
  const s=WIN_S_M/SCALE,pad=WIN_PAD_M/SCALE,yW=A.y+pad+WIN_Y_OFF_M/SCALE; const xLw=A.x+pad,xRw=B.x-pad-s;
  setAttrs(winL,{x:xLw,y:yW,width:s,height:s}); setAttrs(winR,{x:xRw,y:yW,width:s,height:s});
  setAttrs(winLh,{x1:xLw,y1:yW+s/2,x2:xLw+s,y2:yW+s/2}); setAttrs(winLv,{x1:xLw+s/2,y1:yW,x2:xLw+s/2,y2:yW+s});
  setAttrs(winRh,{x1:xRw,y1:yW+s/2,x2:xRw+s,y2:yW+s/2}); setAttrs(winRv,{x1:xRw+s/2,y1:yW,x2:xRw+s/2,y2:yW+s});

  // Traufe AB & Parallele
  setAttrs(lineAB,{x1:A.x,y1:A.y,x2:B.x,y2:B.y}); const yP=A.y-PARALLEL; setAttrs(lineParallel,{x1:A.x,y1:yP,x2:B.x,y2:yP});

  // Breite des Daches in Höhe der Parallelen
  let w=0; if(h>0){ if(PARALLEL<=0) w=L; else if(PARALLEL>=h) w=0; else w=L*(1-(PARALLEL/h)); }
  const percent=L>0?(w/L)*100:0;

  if(w>0){ const half=w/2; const xL=midX-half; const xR=midX+half; setAttrs(segInside,{x1:xL,y1:yP,x2:xR,y2:yP}); segInside.style.display='inline'; setAttrs(fillArea,{x:xL,y:yP,width:w,height:PARALLEL}); fillArea.style.display='inline'; setAttrs(fullLabel,{x:midX,y:yP+PARALLEL/2}); fullLabel.style.display=(percent>=75)?'inline':'none'; }
  else{ segInside.style.display='none'; fillArea.style.display='none'; fullLabel.style.display='none'; }

  percentInfo.textContent=`${percent.toFixed(1)}% des Dachgeschosses ist höher als 2,30 m (${(w*SCALE).toFixed(2)} m von ${width_m.toFixed(2)} m)`;

  // ===== Draufsicht: oben ausrichten, grün mittig, rot außen =====
  const PX=A.x; const PY=A0.y-PLAN_LEN-50; // höher gesetzt, damit mit der Ansicht fluchtet
  setAttrs(planEG,{x:PX,y:PY,width:L,height:PLAN_LEN});
  const wGreen=Math.max(0,Math.min(w,L)); const xGreen=PX+(L-wGreen)/2; setAttrs(planInclude,{x:xGreen,y:PY,width:wGreen,height:PLAN_LEN});
  const leftW=Math.max(0,xGreen-PX); const rightW=Math.max(0,(PX+L)-(xGreen+wGreen));
  setAttrs(planRoofLeft,{x:PX,y:PY,width:leftW,height:PLAN_LEN}); setAttrs(planRoofRight,{x:xGreen+wGreen,y:PY,width:rightW,height:PLAN_LEN});
  setAttrs(fullLabelPlan,{x:PX+L/2,y:PY+PLAN_LEN/2}); fullLabelPlan.style.display=(percent>=75)?'inline':'none';
}
angleInput.addEventListener('input',update);baseInput.addEventListener('input',update);update();
  </script>
</body>
</html>
